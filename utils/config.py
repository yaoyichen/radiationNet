import numpy as np
import torch

norm_mapping_wrf = {'aldif': {'mean': 0.16539352, 'scale': 0.03575806}, 
                    'aldir': {'mean': 0.16539352, 'scale': 0.03575806}, 
                    'asdif': {'mean': 0.16539352, 'scale': 0.03575806}, 
                    'asdir': {'mean': 0.16539352, 'scale': 0.03575806}, 
                    'cosz': {'mean': 0.84524125, 'scale': 0.020037498}, 
                    'landfrac': {'mean': 0.99975306, 'scale': 0.015711544}, 
                    'sicefrac': {'mean': 0.0, 'scale': 0.0}, 
                    'snow': {'mean': 0.0, 'scale': 0.0}, 
                    'solc': {'mean': 1345.336, 'scale': 0.0}, 
                    'tsfc': {'mean': 303.17914, 'scale': 4.3057466}, 
                    'emiss': {'mean': 1.0388682, 'scale': 0.05498103}, 
                    'cldfrac': {'mean': 0.01628679, 'scale': 0.11835434},
                    'o3vmr': {'mean': 1.2141462e-06, 'scale': 2.3178093e-06}, 
                    'play': {'mean': 390.18008, 'scale': 296.30096}, 
                    'tlay': {'mean': 251.01125, 'scale': 32.00044}, 
                    'qc': {'mean': 2.774779e-07, 'scale': 1.0387751e-05}, 
                    'qv': {'mean': 0.002893191, 'scale': 0.003924214}, 
                    'qr': {'mean': 8.839166e-08, 'scale': 2.1570945e-06}, 
                    'qi': {'mean': 1.2064834e-06, 'scale': 1.1339106e-05},
                    'qs': {'mean': 8.0543157e-07, 'scale': 1.1687571e-05}, 
                    'qg': {'mean': 2.2455426e-08, 'scale': 3.822603e-07}, 
                    'swuflx': {'mean': 180.72261, 'scale': 83.99388}, 
                    'swdflx': {'mean': 1006.5645, 'scale': 129.04306}, 
                    'lwuflx': {'mean': 349.25552, 'scale': 73.30407}, 
                    'lwdflx': {'mean': 137.63927, 'scale': 124.870514}}



norm_mapping_standard =  {'aldif': {'mean': 0.0, 'scale': 1.0, 'count': 5.0},
 'aldir': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'asdif': {'mean':0.0, 'scale': 1.0, 'count': 5.0}, 
'asdir': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'cosz': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'landfrac': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'sicefrac': {'mean': 0.0,'scale': 1.0, 'count': 5.0}, 
'snow': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'solc': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'tsfc': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'emiss': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'ccl4vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'cfc11vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'cfc12vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'cfc22vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'ch4vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'cldfrac': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'co2vmr': {'mean': 0.0,'scale': 1.0, 'count': 5.0}, 
'n2ovmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'o2vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'o3vmr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'play': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'qc': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'qg': {'mean': 0.0, 'scale': 1.0, 'count':5.0}, 
'qi': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'qr': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
'qs': {'mean': 0.0, 'scale': 1.0, 'count': 5.0},
 'qv': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
 'tlay': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
 'swuflx': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
 'swdflx': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
 'lwuflx': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
 'lwdflx': {'mean': 0.0, 'scale': 1.0, 'count': 5.0}, 
}



norm_mapping_wrf07 =  {'aldif': {'mean': 1.2225e-01, 'scale': 9.6926e-02*1.4142, 'count': 5.0},
 'aldir': {'mean': 1.2225e-01, 'scale': 9.6926e-02*1.4142, 'count': 5.0}, 
'asdif': {'mean':1.2225e-01, 'scale': 9.6926e-02*1.4142, 'count': 5.0}, 
'asdir': {'mean': 1.2225e-01, 'scale': 9.6926e-02*1.4142, 'count': 5.0}, 
'cosz': {'mean':  2.3448e-01, 'scale': 2.1161e-01*1.4142, 'count': 5.0}, 
'landfrac': {'mean': 9.9922e-01, 'scale': 1.9661e-02*1.4142, 'count': 5.0}, 
'sicefrac': {'mean': 0.0000e+00,'scale': 0.1*1.4142, 'count': 5.0}, 
'snow': {'mean': 1.6870e+00, 'scale': 4.2675e+00*1.4142, 'count': 5.0}, 
'solc': {'mean': 1.0953e+03, 'scale': 3.8823e+02*1.4142, 'count': 5.0}, 
'tsfc': {'mean': 2.8127e+02, 'scale': 1.0318e+01*1.4142, 'count': 5.0}, 
'emiss': {'mean': 8.8330e-01, 'scale': 2.5870e-02*1.4142, 'count': 5.0}, 
'ccl4vmr': {'mean': 9.2996e-11, 'scale': 2.6100e-15*10000*1.4142, 'count': 5.0}, 
'cfc11vmr': {'mean': 2.5108e-10, 'scale': 5.6767e-14*1000*1.4142, 'count': 5.0}, 
'cfc12vmr': {'mean': 5.3810e-10, 'scale': 6.9005e-14*1000*1.4142, 'count': 5.0}, 
'cfc22vmr': {'mean': 1.6901e-10, 'scale': 6.0935e-15*1000*1.4142, 'count': 5.0}, 
'ch4vmr': {'mean': 1.7736e-06, 'scale': 2.9631e-10*1.4142, 'count': 5.0}, 
'cldfrac': {'mean': 3.6548e-02, 'scale': 1.2967e-01*1.4142, 'count': 5.0}, 
'co2vmr': {'mean': 3.7906e-04,'scale': 3.9326e-08*1.4142, 'count': 5.0}, 
'n2ovmr': {'mean': 3.1895e-07, 'scale': 3.7523e-11*1.4142, 'count': 5.0}, 
'o2vmr': {'mean': 2.0944e-01, 'scale': 3.2583e-05*1.4142, 'count': 5.0}, 
'o3vmr': {'mean': 1.2222e-06, 'scale': 1.5227e-06*1.4142, 'count': 5.0}, 
'play': {'mean': 4.0791e+02, 'scale': 2.1855e+02*1.4142, 'count': 5.0}, 
'qc': {'mean': 1.1653e-06, 'scale': 1.8050e-05*1.4142, 'count': 5.0}, 
'qg': {'mean': 9.2002e-08, 'scale': 5.4442e-06*1.4142, 'count':5.0}, 
'qi': {'mean': 5.4701e-08, 'scale': 7.3361e-07*1.4142, 'count': 5.0}, 
'qr': {'mean': 4.2354e-07, 'scale': 7.8923e-06*1.4142, 'count': 5.0}, 
'qs': {'mean': 3.5349e-06, 'scale': 3.7933e-05*1.4142, 'count': 5.0},
 'qv': {'mean': 1.2345e-03, 'scale': 1.5455e-03*1.4142, 'count': 5.0}, 
 'tlay': {'mean': 2.4465e+02, 'scale': 1.9199e+01*1.4142, 'count': 5.0}, 
 'swuflx': {'mean': 73.5557, 'scale': 76.8572*1.4142, 'count': 5.0}, 
 'swdflx': {'mean': 276.5798, 'scale': 256.6423*1.4142, 'count': 5.0}, 
 'lwuflx': {'mean': 279.2660, 'scale': 43.9395*1.4142, 'count': 5.0}, 
 'lwdflx': {'mean': 104.7803, 'scale': 71.7479*1.4142, 'count': 5.0}, 
}




norm_mapping_small = {'aldif': {'mean': 0.07733402495029901, 'scale': 0.14426375905340982}, 'aldir': {'mean': 0.07733402495029901, 'scale': 0.14426375905340982}, 'asdif': {'mean': 0.07733402495029901, 'scale': 0.14426375905340982}, 'asdir': {'mean': 0.07733402495029901, 'scale': 0.14426375905340982}, 'cosz': {'mean': 0.24990819984045695, 'scale': 0.32281969941008914}, 'landfrac': {'mean': 0.32718219097832457, 'scale': 0.46918440392339117}, 'sicefrac': {'mean': 0.04987251948864919, 'scale': 0.21349805289282955}, 'snow': {'mean': 7.069139775059871, 'scale': 35.37339154698258}, 'solc': {'mean': 675.449573007544, 'scale': 675.4495769588103}, 'tsfc': {'mean': 290.0060671896639, 'scale': 16.10186250706953}, 'emiss': {'mean': 0.9690415807189793, 'scale': 0.020907886121743838}, 'ccl4vmr': {'mean': 9.300000000001259e-11, 'scale': 1.258865494729139e-23}, 'cfc11vmr': {'mean': 2.510000000000007e-10, 'scale': 6.72084247699335e-25}, 'cfc12vmr': {'mean': 5.380000000000207e-10, 'scale': 2.0679515313825692e-23}, 'cfc22vmr': {'mean': 1.6900000000000588e-10, 'scale': 5.86781247029804e-24}, 'ch4vmr': {'mean': 1.7740000000000964e-06, 'scale': 9.634999775017666e-20}, 'cldfrac': {'mean': 0.06486385190002748, 'scale': 0.23221686982110262}, 'co2vmr': {
    'mean': 0.0003789999999999624, 'scale': 3.7621815385247004e-17}, 'n2ovmr': {'mean': 3.189999999999797e-07, 'scale': 2.0275851174899814e-20}, 'o2vmr': {'mean': 0.20948799999998594, 'scale': 1.4072076837123859e-14}, 'o3vmr': {'mean': 1.3086193771823524e-06, 'scale': 2.497903860241533e-06}, 'play': {'mean': 433.2784715674021, 'scale': 349.3829250302278}, 'qc': {'mean': 3.4734579541537886e-06, 'scale': 3.651619090712969e-05}, 'qg': {'mean': 3.95572240963548e-08, 'scale': 9.658252160810546e-07}, 'qi': {'mean': 1.7342309114125204e-06, 'scale': 1.1041621699839175e-05}, 'qr': {'mean': 5.015872804306918e-07, 'scale': 6.8198588982021956e-06}, 'qs': {'mean': 7.422841587584547e-07, 'scale': 1.1291736630083783e-05}, 'qv': {'mean': 0.0027685824123561964, 'scale': 0.004541676652300635}, 'tlay': {'mean': 247.3522624502228, 'scale': 31.882175499563953}, 'swuflx': {'mean': 65.83682248182676, 'scale': 114.08526662989976}, 'swdflx': {'mean': 284.93779325031517, 'scale': 385.9458926558632}, 'lwuflx': {'mean': 307.30982851987466, 'scale': 79.95097341102883}, 'lwdflx': {'mean': 133.37528868602683, 'scale': 131.91846491811287}, 'swhr': {'mean': -5.000000000000174e+19, 'scale': 5.000000000000146e+19}, 'lwhr': {'mean': -1.4600210926449122, 'scale': 2.9646242136340737}}

# norm_mapping = {'aldif': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844}, 'aldir': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844}, 'asdif': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844}, 'asdir': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844}, 'cosz': {'mean': 0.24990137022885506, 'scale': 0.32282498638726015}, 'landfrac': {'mean': 0.327104081234134, 'scale': 0.4691556258578874}, 'sicefrac': {'mean': 0.050430486695146826, 'scale': 0.21538408096035264}, 'snow': {'mean': 7.354593674431235, 'scale': 35.835065967063265}, 'solc': {'mean': 677.1947341921689, 'scale': 677.1964330907291}, 'tsfc': {'mean': 289.35141231742716, 'scale': 16.823904155298163}, 'emiss': {'mean': 0.9689459095641935, 'scale': 0.020992535165616884}, 'ccl4vmr': {'mean': 9.29999999999501e-11, 'scale': 4.990225539167562e-23}, 'cfc11vmr': {'mean': 2.5099999999994356e-10, 'scale': 5.645507680674414e-23}, 'cfc12vmr': {'mean': 5.379999999988099e-10, 'scale': 1.1901061063106686e-21}, 'cfc22vmr': {'mean': 1.6900000000010907e-10, 'scale': 1.0905859388628824e-22}, 'ch4vmr': {'mean': 1.774000000002082e-06, 'scale': 2.0820069843510702e-18}, 'cldfrac': {'mean': 0.06853968114899121, 'scale': 0.23759317292501117}, 'co2vmr': {'mean': 0.0003789999999999699,
#                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               'scale': 3.008661028647275e-17}, 'n2ovmr': {'mean': 3.1899999999941876e-07, 'scale': 5.812234204940602e-19}, 'o2vmr': {'mean': 0.20948800000033244, 'scale': 3.324285291483875e-13}, 'o3vmr': {'mean': 1.3196645754878249e-06, 'scale': 2.5155499649497093e-06}, 'play': {'mean': 432.698051728305, 'scale': 349.4268025311715}, 'qc': {'mean': 4.604153201410104e-06, 'scale': 4.201097584218835e-05}, 'qg': {'mean': 4.4017776859794616e-08, 'scale': 9.436231403506897e-07}, 'qi': {'mean': 1.8733384656618254e-06, 'scale': 1.1321658029546551e-05}, 'qr': {'mean': 5.946286502625401e-07, 'scale': 7.289297723442461e-06}, 'qs': {'mean': 8.129583061654891e-07, 'scale': 1.1850811201040899e-05}, 'qv': {'mean': 0.0027444326096282747, 'scale': 0.004553794187822268}, 'tlay': {'mean': 246.63544632557782, 'scale': 32.05512876345207}, 'swuflx': {'mean': 75.96255499936377, 'scale': 129.07228665961964}, 'swdflx': {'mean': 282.2801633975395, 'scale': 385.2729110541759}, 'lwuflx': {'mean': 303.2404827075497, 'scale': 80.57667180932746}, 'lwdflx': {'mean': 133.6329855589623, 'scale': 133.5923404547903}, 'swhr': {'mean': -4.9999999999992365e+19, 'scale': 5.000000000001639e+19}, 'lwhr': {'mean': -1.4521109158233443, 'scale': 3.0945696772535447}}
norm_mapping = {'aldif': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844},
                'aldir': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844},
                'asdif': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844},
                'asdir': {'mean': 0.07628345257879962, 'scale': 0.14555045910111844},
                'cosz': {'mean': 0.24990137022885506, 'scale': 0.32282498638726015},
                'landfrac': {'mean': 0.327104081234134, 'scale': 0.4691556258578874},
                'sicefrac': {'mean': 0.050430486695146826, 'scale': 0.21538408096035264},
                'snow': {'mean': 7.354593674431235, 'scale': 35.835065967063265},
                'solc': {'mean': 677.1947341921689, 'scale': 677.1964330907291},
                'tsfc': {'mean': 289.35141231742716, 'scale': 16.823904155298163},
                'emiss': {'mean': 0.9689459095641935, 'scale': 0.020992535165616884},
                'ccl4vmr': {'mean': 9.29999999999501e-11, 'scale': 4.990225539167562e-23},
                'cfc11vmr': {'mean': 2.5099999999994356e-10, 'scale': 5.645507680674414e-23},
                'cfc12vmr': {'mean': 5.379999999988099e-10, 'scale': 1.1901061063106686e-21},
                'cfc22vmr': {'mean': 1.6900000000010907e-10, 'scale': 1.0905859388628824e-22},
                'ch4vmr': {'mean': 1.774000000002082e-06, 'scale': 2.0820069843510702e-18},
                'cldfrac': {'mean': 0.06853968114899121, 'scale': 0.23759317292501117},
                'co2vmr': {'mean': 0.0003789999999999699, 'scale': 3.008661028647275e-17},
                'n2ovmr': {'mean': 3.1899999999941876e-07, 'scale': 5.812234204940602e-19},
                'o2vmr': {'mean': 0.20948800000033244, 'scale': 3.324285291483875e-13},
                'o3vmr': {'mean': 1.3196645754878249e-06, 'scale': 2.5155499649497093e-06},
                'play': {'mean': 432.698051728305, 'scale': 349.4268025311715},
                'qc': {'mean': 4.604153201410104e-06, 'scale': 4.201097584218835e-05},
                'qg': {'mean': 4.4017776859794616e-08, 'scale': 9.436231403506897e-07},
                'qi': {'mean': 1.8733384656618254e-06, 'scale': 1.1321658029546551e-05},
                'qr': {'mean': 5.946286502625401e-07, 'scale': 7.289297723442461e-06},
                'qs': {'mean': 8.129583061654891e-07, 'scale': 1.1850811201040899e-05},
                'qv': {'mean': 0.0027444326096282747, 'scale': 0.004553794187822268},
                'tlay': {'mean': 246.63544632557782, 'scale': 32.05512876345207},
                'swuflx': {'mean': 75.96255499936377, 'scale': 129.07228665961964},
                'swdflx': {'mean': 282.2801633975395, 'scale': 385.2729110541759},
                'lwuflx': {'mean': 303.2404827075497, 'scale': 80.57667180932746},
                'lwdflx': {'mean': 133.6329855589623, 'scale': 133.5923404547903}}


norm_mapping_fullyear = {'aldif': {'mean': 0.07696025877812071, 'scale': 0.15143388863539975, 'count': 5.0}, 'aldir': {'mean': 0.07696025877812071, 'scale': 0.15143388863539975, 'count': 5.0}, 
'asdif': {'mean': 0.07696025877812071, 'scale': 0.15143388863539975, 'count': 5.0}, 
'asdir': {'mean': 0.07696025877812071, 'scale': 0.15143388863539975, 'count': 5.0}, 
'cosz': {'mean': 0.25607745853001596, 'scale': 0.3305328409005959, 'count': 5.0}, 
'landfrac': {'mean': 0.2789158589203377, 'scale': 0.48141504378953337, 'count': 5.0}, 
'sicefrac': {'mean': 0.024454165799585204,'scale': 0.15066591539970534, 'count': 5.0}, 
'snow': {'mean': 11.302514282362063, 'scale': 42.87290401221356, 'count': 5.0}, 
'solc': {'mean': 693.7427722521219, 'scale': 706.0606271215925, 'count': 5.0}, 
'tsfc': {'mean': 289.19578165744355, 'scale': 18.483565936626643, 'count': 5.0}, 
'emiss': {'mean': 0.9696964875073835, 'scale': 0.021520645994960876, 'count': 5.0}, 
'ccl4vmr': {'mean': 9.300000000002044e-11, 'scale': 2.0683651216888453e-23, 'count': 5.0}, 
'cfc11vmr': {'mean': 2.509999999999694e-10, 'scale': 3.3054137277618987e-23, 'count': 5.0}, 
'cfc12vmr': {'mean': 5.380000000000145e-10, 'scale': 1.9248492854108954e-23, 'count': 5.0}, 
'cfc22vmr': {'mean': 1.689999999999571e-10, 'scale': 4.719168792191592e-23, 'count': 5.0}, 
'ch4vmr': {'mean': 1.7739999999997727e-06, 'scale': 2.511622095198451e-19, 'count': 5.0}, 
'cldfrac': {'mean': 0.052887799932715106, 'scale': 0.21280771797915113, 'count': 5.0}, 
'co2vmr': {'mean': 0.00037899999999993587, 'scale': 6.903115232215206e-17, 'count': 5.0}, 
'n2ovmr': {'mean': 3.1900000000004313e-07, 'scale': 4.6303056061656333e-20, 'count': 5.0}, 
'o2vmr': {'mean': 0.2094879999999765, 'scale': 2.5428548156014588e-14, 'count': 5.0}, 
'o3vmr': {'mean': 1.3093404493784795e-06, 'scale': 2.508586197157427e-06, 'count': 5.0}, 
'play': {'mean': 434.5666397015563, 'scale': 352.64759614592776, 'count': 5.0}, 
'qc': {'mean': 3.837828775616568e-06, 'scale': 3.81230187197e-05, 'count': 5.0}, 
'qg': {'mean': 4.762856037990208e-08, 'scale': 1.34594678152702e-06, 'count':5.0}, 
'qi': {'mean': 1.6059618222480042e-06, 'scale': 1.0793740974679207e-05, 'count': 5.0}, 
'qr': {'mean': 5.545863663084633e-07, 'scale': 7.369434583515737e-06, 'count': 5.0}, 
'qs': {'mean': 8.842259495156865e-07, 'scale': 1.3718948913066267e-05, 'count': 5.0},
 'qv': {'mean': 0.0028722649755788692, 'scale': 0.004951102635541286, 'count': 5.0}, 
 'tlay': {'mean': 247.55258291812325, 'scale': 32.56774606705561, 'count': 5.0}, 
 'swuflx': {'mean': 74.00990170576021, 'scale': 130.3430928136532, 'count': 5.0}, 
 'swdflx': {'mean': 299.1417333589608, 'scale': 408.84257208608244, 'count': 5.0}, 
 'lwuflx': {'mean': 307.3292347423114, 'scale': 84.40893423216852, 'count': 5.0}, 
 'lwdflx': {'mean': 133.93609882802502, 'scale': 135.1705646036153, 'count': 5.0}, 
}


norm_mapping_fullyear_new = {'aldif': {'mean': 0.08286888152360916, 'scale': 0.15738269686698914}, 
 'aldir': {'mean': 0.08286888152360916, 'scale': 0.15738269686698914}, 
 'asdif': {'mean': 0.08286888152360916, 'scale': 0.15738269686698914}, 
 'asdir': {'mean': 0.08286888152360916, 'scale': 0.15738269686698914}, 
 'cosz': {'mean': 0.25022029876708984, 'scale': 0.3229803740978241}, 
 'landfrac': {'mean': 0.3384599983692169, 'scale': 0.47318586707115173}, 
 'sicefrac': {'mean': 0.044816140085458755, 'scale': 0.20278969407081604}, 
 'snow': {'mean': 10.626215934753418, 'scale': 44.547794342041016}, 
 'solc': {'mean': 685.3978881835938, 'scale': 685.9473876953125}, 
 'tsfc': {'mean': 288.45941162109375, 'scale': 17.315994262695312}, 
 'emiss': {'mean': 0.9679243564605713, 'scale': 0.021532000973820686},
 'ccl4vmr': {'mean': 9.30723553782542e-11, 'scale': 7.234124865980462e-14*100},
 'cfc11vmr': {'mean': 2.510198160443622e-10, 'scale': 1.98199932892806e-14*100}, 
 'cfc12vmr': {'mean': 5.383177237305858e-10, 'scale': 3.177636918785115e-13*100}, 
 'cfc22vmr': {'mean': 1.6909856848101867e-10, 'scale': 9.85449853771643e-14*100}, 
 'ch4vmr': {'mean': 1.7733642607709044e-06, 'scale': 6.35942298821135e-10*100}, 
 'cldfrac': {'mean': 0.05548079311847687, 'scale': 0.21496924757957458}, 
 'co2vmr': {'mean': 0.0003790650807786733, 'scale': 6.507583805159811e-08*100}, 
 'n2ovmr': {'mean': 3.190662596352922e-07, 'scale': 6.627053766861124e-11*100}, 
 'o2vmr': {'mean': 0.20965276658535004, 'scale': 0.00016471688286401331*100},
 'o3vmr': {'mean': 1.3125825262250146e-06, 'scale': 2.4872508674889104e-06}, 
 'play': {'mean': 433.0677185058594, 'scale': 349.6716613769531}, 
 'qc': {'mean': 3.922477390005952e-06, 'scale': 3.8204445445444435e-05},
 'qg': {'mean': 5.645986789204471e-08, 'scale': 2.0075312932021916e-06}, 
 'qi': {'mean': 1.7248669337277533e-06, 'scale': 1.1120398085040506e-05}, 
 'qr': {'mean': 5.804363354400266e-07, 'scale': 8.371523108507972e-06}, 
 'qs': {'mean': 1.0286310043738922e-06, 'scale': 1.5505058399867266e-05}, 
 'qv': {'mean': 0.002689928514882922, 'scale': 0.004563615191727877},
 'tlay': {'mean': 247.05052185058594, 'scale': 31.68449592590332}, 
 'swuflx': {'mean': 74.113525390625, 'scale': 128.90025329589844}, 
 'swdflx': {'mean': 289.0264892578125, 'scale': 391.9402770996094}, 
 'lwuflx': {'mean': 304.0531005859375, 'scale': 80.12698364257812}, 
 'lwdflx': {'mean': 131.58193969726562, 'scale': 131.71212768554688}}

 # 'swhr': {'mean': 0.7057762906142299, 'scale': 1.3601279447792651, 'count': 5.0}, 
 # 'lwhr': {'mean': -1.4789121388668107, 'scale': 2.943087042294238, 'count': 5.0}


climart_96_feature_mean =   torch.tensor([2.2001e-01, 2.7896e+02, 9.6671e+04, 4.9198e-06, 9.7688e-01, 3.0831e-01,
        2.9155e-01, 1.4410e-01, 1.0925e-01, 3.2953e-01, 3.4302e-01, 2.0540e-01,
        1.7407e-01, 4.2284e-01, 2.6782e-02, 0.0000e+00, 0.0000e+00, 7.0956e-01,
        1.6583e-01, 1.1426e+02, 7.1792e+00, 0.0000e+00, 0.0000e+00, 2.8288e+02,
        1.9745e+02, 3.3398e-01, 3.1350e-03, 0.0000e+00, 0.0000e+00, 5.5340e-01,
        1.0948e-01, 1.9335e-01, 1.4550e-02, 0.0000e+00, 0.0000e+00, 5.9106e-02,
        1.5444e-01, 1.9850e-01, 1.2046e-02, 0.0000e+00, 0.0000e+00, 6.6276e-02,
        1.1757e-01, 9.6323e-02, 1.2046e-02, 0.0000e+00, 0.0000e+00, 6.8864e-02,
        2.5564e-02, 7.2807e-02, 1.2046e-02, 0.0000e+00, 0.0000e+00, 7.0298e-02,
        3.2228e-03, 1.9335e-01, 1.4550e-02, 0.0000e+00, 0.0000e+00, 8.8730e-02,
        1.5481e-01, 1.9850e-01, 1.2046e-02, 0.0000e+00, 0.0000e+00, 1.3628e-01,
        1.1984e-01, 9.6323e-02, 1.2046e-02, 0.0000e+00, 0.0000e+00, 1.5109e-01,
        2.9063e-02, 7.2807e-02, 1.2046e-02, 0.0000e+00, 0.0000e+00, 1.5901e-01,
        4.3464e-03, 2.1110e-04, 1.6600e-04, 1.5142e-03, 3.9131e-01, 2.4492e+02,
        3.7757e+04, 3.0484e-06, 1.8691e-03, 1.0456e+03, 2.0173e-02, 5.5543e-04,
        9.7164e-07, 4.7645e-07, 3.1766e-09, 2.1784e-09, 1.9504e+03, 3.8400e-01]).unsqueeze(-1)



# climart_96_feature_std  = torch.tensor([2.2635e-01, 6.3000e+00, 4.9265e+03, 2.2295e-08, 1.1316e-02, 9.0726e-02,
#         1.1240e-01, 8.6097e-02, 8.3367e-02, 9.2064e-02, 1.0893e-01, 9.2912e-02,
#         9.4633e-02, 3.6395e-01, 8.8820e-02, 0.0001e+00, 0.0001e+00, 2.9262e-01,
#         1.1204e-01, 1.0357e+02, 2.3541e+01, 0.0001e+00, 0.0001e+00, 5.5749e+00,
#         8.1753e+01, 3.1318e-01, 1.1212e-02, 0.0001e+00, 0.0001e+00, 2.9409e-01,
#         7.3967e-02, 1.3285e-01, 4.6751e-02, 0.0001e+00, 0.0001e+00, 3.6464e-02,
#         1.0044e-01, 1.5102e-01, 3.9290e-02, 0.0001e+00, 0.0001e+00, 6.5385e-02,
#         7.6431e-02, 9.9092e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 7.6201e-02,
#         1.8770e-02, 8.7445e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 8.2082e-02,
#         3.5232e-03, 1.3285e-01, 4.6751e-02, 0.0001e+00, 0.0001e+00, 5.0426e-02,
#         1.0067e-01, 1.5102e-01, 3.9290e-02, 0.0001e+00, 0.0001e+00, 9.9370e-02,
#         7.8072e-02, 9.9092e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 1.1604e-01,
#         2.2136e-02, 8.7445e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 1.2212e-01,
#         4.7417e-03, 4.7698e-01, 4.7618e-01, 1.8454e-01, 3.8121e-01, 2.6401e+01,
#         3.6970e+04, 4.1361e-06, 2.9072e-03, 1.0463e+03, 1.7615e-02, 4.7965e-09,
#         6.8416e-12, 2.2130e-12, 9.4650e-14, 4.5795e-14, 1.7129e+03, 3.6584e+00]).unsqueeze(-1)


climart_96_feature_std  = torch.tensor([2.2635e-01, 6.3000e+00, 4.9265e+03, 2.2295e-07, 1.1316e-02, 9.0726e-02,
        1.1240e-01, 8.6097e-02, 8.3367e-02, 9.2064e-02, 1.0893e-01, 9.2912e-02,
        9.4633e-02, 3.6395e-01, 8.8820e-02, 0.0001e+00, 0.0001e+00, 2.9262e-01,
        1.1204e-01, 1.0357e+02, 2.3541e+01, 0.0001e+00, 0.0001e+00, 5.5749e+00,
        8.1753e+01, 3.1318e-01, 1.1212e-02, 0.0001e+00, 0.0001e+00, 2.9409e-01,
        7.3967e-02, 1.3285e-01, 4.6751e-02, 0.0001e+00, 0.0001e+00, 3.6464e-02,
        1.0044e-01, 1.5102e-01, 3.9290e-02, 0.0001e+00, 0.0001e+00, 6.5385e-02,
        7.6431e-02, 9.9092e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 7.6201e-02,
        1.8770e-02, 8.7445e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 8.2082e-02,
        3.5232e-03, 1.3285e-01, 4.6751e-02, 0.0001e+00, 0.0001e+00, 5.0426e-02,
        1.0067e-01, 1.5102e-01, 3.9290e-02, 0.0001e+00, 0.0001e+00, 9.9370e-02,
        7.8072e-02, 9.9092e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 1.1604e-01,
        2.2136e-02, 8.7445e-02, 3.9290e-02, 0.0001e+00, 0.0001e+00, 1.2212e-01,
        4.7417e-03, 4.7698e-01, 4.7618e-01, 1.8454e-01, 3.8121e-01, 2.6401e+01,
        3.6970e+04, 4.1361e-05, 2.9072e-03, 1.0463e+03, 1.7615e-02, 4.7965e-05,
        6.8416e-8, 2.2130e-8, 9.4650e-10, 4.5795e-10, 1.7129e+03, 3.6584e+00]).unsqueeze(-1)

climart_96_target_mean =  torch.tensor([53.4817, 267.9034, 280.4040,  93.5093]).unsqueeze(-1)
# climart_96_target_std  = torch.tensor([ 50.2501, 281.3003,  47.0234, 101.9949]).unsqueeze(-1)
climart_96_target_std  = torch.tensor([ 50.2501, 100,  47.0234, 101.9949]).unsqueeze(-1)




def check_distribution():
    import numpy as np
    dict1 = norm_mapping
    dict2 = norm_mapping_fullyear
    
    dict4 = norm_mapping_fullyear_new
    
    dict3 = {"ccl4vmr": {"mean": 0.093*10**(-9)},
            "cfc11vmr": {"mean":0.251*10**(-9)},
            "cfc12vmr": {"mean":0.538*10**(-9)},
            "cfc22vmr": {"mean":0.169*10**(-9)},
            "ch4vmr": {"mean":1774*10**(-9)},
            "co2vmr": {"mean":0.000379},
            "n2ovmr": {"mean":319*10**(-9)},
            "o2vmr":{"mean": 0.209488} }
    
    dict5 = norm_mapping_wrf
    
    
    for key,value in dict5.items():
        mean1 = dict1[key]["mean"]
        std1 = dict1[key]["scale"]
        
        mean2 = dict2[key]["mean"]
        std2 = dict2[key]["scale"]
        
        mean5 = dict5[key]["mean"]
        std5 = dict5[key]["scale"]
        # mean3 = dict3[key]["mean"]
        
        result = np.abs(mean5 + std5 - mean2)/std2
        # print(f"\"{key}\":{mean2}")
        
        print(key, result)
    
    
    
if __name__ == "__main__":
    check_distribution()